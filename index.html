<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>For Elly ðŸ’Œ</title>

  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">

  <!-- Main Styles -->
  <style>
    :root {
      --pink-light: #ffb6c1;
      --pink: #ff69b4;
      --pink-dark: #c94e68;
      --bg-light: rgba(255, 248, 248, 0.95);
      --bg-overlay: rgba(255,255,255,0.9);
      --text-dark: #333;
      --radius: 12px;
      --transition: 0.3s ease;
      --bg-color: var(--bg-overlay);
      --text-color: var(--text-dark);
    }
    [data-theme="dark"] {
      --bg-color: #2c2c2c;
      --text-color: #eee;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body {
      height: 100%; font-family: 'Poppins', sans-serif;
      background: url('https://amsterdamian.com/wp-content/uploads/2021/03/tulips-7jpg_s.jpg') no-repeat center center fixed;
      background-size: cover; scroll-behavior: smooth; overflow-x: hidden;
      color: var(--text-color);
    }
    header {
      position: fixed; top: 0; width: 100%; transition: background var(--transition), transform var(--transition);
      background: var(--bg-color); backdrop-filter: blur(10px); z-index:1000;
    }
    header.scrolled { transform: translateY(-80%); }
    nav { max-width:1100px; margin:auto; display:flex; justify-content:center; gap:2rem; padding:0.5rem; }
    nav a { font-weight:500; color:var(--pink-dark); text-decoration:none; padding:0.5rem; border-radius:var(--radius); transition:var(--transition); }
    nav a.active, nav a:hover { background:var(--pink-light); color:#fff; }
    #themeToggle { position: absolute; right:1rem; top:1rem; background:none; border:none; cursor:pointer; font-size:1.2em; }

    main { padding-top:4rem; }
    .screen { display:none; padding:6rem 1rem 1rem; justify-content:center; align-items:flex-start; text-align:center; }
    .screen.active { display:flex; }
    h1 { font-size:2.5em; color:var(--pink-dark); margin-bottom:0.5em; }

    /* Home */
    .intro h1 { font-family:'Pacifico', cursive; color:#ffeef2; font-size:3.5em; text-shadow:2px 2px 6px rgba(0,0,0,0.4); animation:bounce 1.5s infinite alternate; }
    .intro button { padding:14px 36px; font-size:1.3em; background:linear-gradient(to right,var(--pink-light),var(--pink)); color:#fff; border:none; border-radius:30px; cursor:pointer; box-shadow:0 8px 20px rgba(255,105,180,0.4); animation:pulse 2s infinite; transition:transform .2s; }
    .intro button:hover { transform:scale(1.05); }

    /* Anniversary */
    .overlay { background:var(--bg-color); padding:2rem; border-radius:var(--radius); max-width:800px; width:95%; max-height:85vh; overflow-y:auto; box-shadow:0 8px 40px rgba(0,0,0,0.1); margin:auto; }
    #dayCounter { font-size:1.2em; margin-bottom:1em; color:var(--pink-dark); }
    #typedText { font-size:1.2em; line-height:1.7; white-space:pre-wrap; opacity:0; transition:opacity 1s ease; min-height:150px; margin-bottom:2rem; color:var(--pink-dark); }

    /* Gallery & Lightbox */
    .gallery { display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:1rem; margin-bottom:2rem; }
    .photo-card { position:relative; border-radius:var(--radius); overflow:hidden; box-shadow:0 4px 12px rgba(0,0,0,0.2); transition:transform var(--transition); cursor:pointer; }
    .photo-card img { width:100%; height:200px; object-fit:cover; display:block; }
    .photo-card:hover, .photo-card:focus { transform:scale(1.03); }
    .photo-card .caption { position:absolute; bottom:0; width:100%; background:var(--pink-light); color:#fff; padding:0.5rem; font-size:0.9em; }
    #lightbox { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); display:none; align-items:center; justify-content:center; z-index:2000; }
    #lightbox img { max-width:90%; max-height:80%; }
    #lightbox .close { position:absolute; top:2rem; right:2rem; font-size:2rem; color:#fff; cursor:pointer; }

    /* Timeline */
    .timeline { display:flex; overflow-x:auto; gap:2rem; padding:1rem 0; }
    .timeline-item { flex:0 0 auto; background:var(--bg-light); padding:1rem; border-radius:var(--radius); min-width:200px; }

    /* Scroll-to-top */
    #toTop { position:fixed; bottom:1rem; right:1rem; padding:0.8rem; background:var(--pink); color:#fff; border:none; border-radius:50%; font-size:1.5em; cursor:pointer; display:none; }

    /* Animations */
    @keyframes fadeIn { from{opacity:0;transform:translateY(20px);} to{opacity:1;transform:translateY(0);} }
    @keyframes bounce { 0%{transform:translateY(0);}100%{transform:translateY(-8px);} }
    @keyframes pulse { 0%{box-shadow:0 0 0 0 rgba(255,105,180,0.5);}70%{box-shadow:0 0 0 15px rgba(255,105,180,0);}100%{box-shadow:0;} }
  </style>
</head>
<body data-theme="light">
  <!-- Floating hearts -->
  <script>
    setInterval(() => {
      const heart = document.createElement('div');
      heart.className = 'heart';
      heart.innerHTML = 'â¤ï¸';
      heart.style.position = 'fixed';
      heart.style.left = Math.random()*100 + 'vw';
      heart.style.top = Math.random()*100 + 'vh';
      heart.style.pointerEvents = 'none';
      document.body.appendChild(heart);
      heart.animate(
        [{ transform: 'scale(1)', opacity: 1 }, { transform: 'scale(0)', opacity: 0 }],
        { duration: 2000 }
      );
      setTimeout(() => heart.remove(), 2000);
    }, 800);
  </script>

  <!-- Background music with controls -->
  <div style="position:fixed; bottom:1rem; left:1rem; z-index:1000;">
    <button id="musicToggle">ðŸ”Š</button>
    <audio id="bgMusic" loop>
      <source src="https://cdn.pixabay.com/download/audio/2023/03/26/audio_2f93402b08.mp3?filename=romantic-music-144109.mp3" type="audio/mp3">
    </audio>
  </div>

  <!-- Header -->
  <header role="banner">
    <nav role="navigation">
      <a href="#home" class="active" onclick="navigate(event,'home')" tabindex="0">Home</a>
      <a href="#anniversary" onclick="navigate(event,'anniversary')" tabindex="0">Letter</a>
      <a href="#timeline" onclick="navigate(event,'timeline')" tabindex="0">Timeline</a>
      <a href="https://open.spotify.com/playlist/37i9dQZF1DX3rxVfibe1L0" target="_blank" tabindex="0">Playlist ðŸŽµ</a>
    </nav>
    <button id="themeToggle" aria-label="Toggle theme">ðŸŒ™</button>
  </header>

  <main>
    <!-- Home -->
    <section id="home" class="screen active" role="region" aria-labelledby="home-heading">
      <div class="intro">
        <h1 id="home-heading">For Elly ðŸ’Œ</h1>
        <button onclick="navigate(null,'anniversary')">Open</button>
      </div>
    </section>

    <!-- Anniversary -->
    <section id="anniversary" class="screen" role="region" aria-labelledby="ann-heading">
      <div class="overlay reveal">
        <p id="dayCounter" aria-live="polite"></p>
        <h1 id="ann-heading">Happy 7 Months, Elly ðŸŒ¸</h1>
        <div id="typedText"></div>

        <!-- Gallery -->
        <div class="gallery">
          <div class="photo-card"><img loading="lazy" src="..." alt="Photo"><div class="caption">Moment</div></div>
        </div>
      </div>
    </section>

    <!-- Timeline -->
    <section id="timeline" class="screen" role="region" aria-labelledby="timeline-heading">
      <div class="overlay reveal">
        <h2 id="timeline-heading">Our Journey Timeline</h2>
        <div class="timeline">
          <div class="timeline-item"><strong>2024-09-06</strong><p>First Met Online</p></div>
          <div class="timeline-item"><strong>2024-10-12</strong><p>First Painting Date</p></div>
          <div class="timeline-item"><strong>2024-11-25</strong><p>Started Dating</p></div>
        </div>
      </div>
    </section>
  </main>

  <!-- Lightbox -->
  <div id="lightbox" role="dialog" aria-modal="true">
    <span class="close" aria-label="Close lightbox">Ã—</span>
    <img src="" alt="Expanded photo">
  </div>

  <!-- Scroll to Top -->
  <button id="toTop" aria-label="Scroll to top">â†‘</button>

  <!-- JavaScript -->
  <script>
    // Navigation
    function navigate(e, id) {
      if (e) e.preventDefault();
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      document.querySelectorAll('nav a').forEach(a => a.classList.remove('active'));
      document.querySelector(`nav a[href="#${id}"]`).classList.add('active');
      if (id === 'anniversary') startTyping();
    }

    // Typing effect
    function startTyping() {
      const txt = `I wish I could be right beside you today, but until then.\n\nThank you for being my sunshine and softness through it all.\n\nI might not always say it the right way, but I hope you always feel how deeply I love you.\n\nHereâ€™s to every beautiful, silly, and perfectly imperfect moment weâ€™ve shared. ðŸ’–`;
      let i = 0;
      const tgt = document.getElementById('typedText');
      tgt.textContent = '';
      tgt.style.opacity = 0;
      (function type() {
        if (i < txt.length) {
          tgt.textContent += txt.charAt(i++);
          setTimeout(type, 35);
        } else {
          tgt.style.opacity = 1;
        }
      })();
    }

    // Anniversary Day Counter
    (function() {
      const start = new Date('2024-11-25');
      const diff = Math.floor((new Date() - start) / (1000 * 60 * 60 * 24));
      document.getElementById('dayCounter').textContent = `We've been together for ${diff} days ðŸ’˜`;
    })();

    // Theme Toggle
    const themeBtn = document.getElementById('themeToggle');
    themeBtn.addEventListener('click', () => {
      const theme = document.body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
      document.body.setAttribute('data-theme', theme);
      themeBtn.textContent = theme === 'dark' ? 'â˜€ï¸' : 'ðŸŒ™';
      localStorage.setItem('theme', theme);
    });
    const saved = localStorage.getItem('theme'); if (saved) document.body.setAttribute('data-theme', saved);

    // Music Toggle
    const music = document.getElementById('bgMusic'), mBtn = document.getElementById('musicToggle');
    mBtn.addEventListener('click', () => { if (music.paused) { music.play(); mBtn.textContent='ðŸ”‡'; } else { music.pause(); mBtn.textContent='ðŸ”Š'; }});

    // Scroll header, reveal animations & to-top button
    const toTop = document.getElementById('toTop');
    let lastY = window.scrollY;
    window.addEventListener('scroll', () => {
      document.querySelector('header').classList.toggle('scrolled', window.scrollY > lastY);
      document.querySelectorAll('.reveal').forEach(el => { if (el.getBoundingClientRect().top < window.innerHeight * 0.9) el.style.animation = 'fadeIn 0.6s forwards'; });
      lastY = window.scrollY;
      toTop.style.display = window.scrollY > 300 ? 'block' : 'none';
    });
    toTop.addEventListener('click', () => window.scrollTo({top:0, behavior:'smooth'}));

    // Lightbox logic & ESC key
    const lb = document.getElementById('lightbox');
    document.querySelectorAll('.photo-card img').forEach(img => img.addEventListener('click', () => { lb.querySelector('img').src = img.src; lb.style.display = 'flex'; }));
    document.querySelector('#lightbox .close').addEventListener('click', () => lb.style.display='none');
    window.addEventListener('keydown', (e) => { if (e.key === 'Escape' && lb.style.display==='flex') lb.style.display='none'; });

    // Service Worker
    if ('serviceWorker' in navigator) window.addEventListener('load', () => navigator.serviceWorker.register('/service-worker.js'));
  </script>
</body>
</html>
